<odoo>

    <template id="report_timesheet_custom" inherit_id="hr_timesheet.timesheet_table">
		<xpath expr="//div[1]/div[1]/table[1]/tbody[1]" position="replace">
			<tbody>
				<t t-set="total_planned_hours" t-value="docs.get_report_timesheet_custom()"/>
				<tr t-foreach="lines" t-as="line">
					<td>
						<span t-field="line.date"/>
					</td>
					<td>
						<span t-field="line.user_id.partner_id.name"/>
						<span t-if="not line.user_id.partner_id.name" t-field="line.employee_id"/>
					</td>
					<td >
						<span t-field="line.name" t-options="{'widget': 'text'}"/>
					</td>
					<td t-if="show_project">
						<span t-field="line.project_id.sudo().name"/>
					</td>
					<td t-if="show_task">
						<t t-if="line.task_id"><span t-field="line.task_id.sudo().name"/></t>
					</td>
					<td class="text-right">
						<span t-if="is_uom_day" t-esc="line._get_timesheet_time_day()" t-options="{'widget': 'timesheet_uom'}"/>
						<span t-else="" t-field="line.unit_amount" t-options="{'widget': 'duration', 'digital': True, 'unit': 'hour', 'round': 'minute'}"/>
					</td>
				</tr>

				<tr>
					<t t-set="nbCols" t-value="4"/>
					<t t-if="show_project" t-set="nbCols" t-value="nbCols + 1"/>
					<t t-if="show_task" t-set="nbCols" t-value="nbCols + 1"/>
					<td class="text-right" t-attf-colspan="{{nbCols}}">
						<strong t-if="is_uom_day">
							<span style="margin-right: 15px;">Horas consumidas (Dias)</span>
							<t t-esc="lines._convert_hours_to_days(sum(lines.mapped('unit_amount')))" t-options="{'widget': 'timesheet_uom'}"/>
						</strong>
						<strong t-else="">
							<span style="margin-right: 15px;">Horas consumidas (Horas)</span>
							<t t-esc="sum(lines.mapped('unit_amount'))" t-options="{'widget': 'duration', 'digital': True, 'unit': 'hour', 'round': 'minute'}"/>
						</strong>
					</td>
				</tr>

				<tr>
					<t t-set="nbCols" t-value="4"/>
					<t t-if="show_project" t-set="nbCols" t-value="nbCols + 1"/>
					<t t-if="show_task" t-set="nbCols" t-value="nbCols + 1"/>
					<td class="text-right" t-attf-colspan="{{nbCols}}">
						<strong t-if="is_uom_day">
							<span style="margin-right: 15px;">Horas contratadas (Dias)</span>
							<t t-esc="lines._convert_hours_to_days(total_planned_hours['planned_hours'])" t-options="{'widget': 'timesheet_uom'}"/>
						</strong>
						<strong t-else="">
							<span style="margin-right: 15px;">Horas contratadas (Horas)</span>
							<t t-esc="total_planned_hours['planned_hours']" t-options="{'widget': 'duration', 'digital': True, 'unit': 'hour', 'round': 'minute'}"/>
						</strong>
					</td>
				</tr>

				<tr>
					<t t-set="nbCols" t-value="4"/>
					<t t-if="show_project" t-set="nbCols" t-value="nbCols + 1"/>
					<t t-if="show_task" t-set="nbCols" t-value="nbCols + 1"/>
					<td class="text-right" t-attf-colspan="{{nbCols}}">
						<t t-set="resta" t-value="total_planned_hours['planned_hours'] - sum(docs.mapped('unit_amount'))" />
						<strong t-if="is_uom_day">
							<span style="margin-right: 15px;">Horas restantes (Dias)</span>
							<t t-esc="lines._convert_hours_to_days(resta)*-1" t-options="{'widget': 'timesheet_uom'}"/>
						</strong>
						<strong t-else="">
							<span style="margin-right: 15px;">Horas restantes (Horas)</span>
							<t t-esc="resta" t-options="{'widget': 'duration', 'digital': True, 'unit': 'hour', 'round': 'minute'}"/>
						</strong>
					</td>
				</tr>

			</tbody>
		</xpath>
	</template>
	
</odoo>